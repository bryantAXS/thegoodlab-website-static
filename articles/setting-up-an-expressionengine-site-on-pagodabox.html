<!DOCTYPE html>

<!--[if lt IE 7 ]><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" class="no-js ie8"><![endif]-->
<!--[if gt IE 8 ]><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" class="no-js ie9"><![endif]-->
<!--[if !IE]><!--><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" class="no-js"><!--<![endif]-->
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	
	
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	
	
	
	<!--[if lt IE 7 ]>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
		<script>
			CFInstall.check({
			     onmissing: function(){window.location.href = "/ie6/"}
			});
		</script>
	<![endif]-->

	<!--[if IE]>
  <script src="/assets/js/PIE.js"></script>
  <link rel="stylesheet" href="/assets/css/ie.css" />
	<![endif]-->
	
	<title>The Good Lab - Chicago, IL  : The Good Lab is a holistic web development company that focuses on building lean, smart and scalable websites, web applications and e-commerce platforms.</title>
  <meta name="description" content="About
The Good Lab is a holistic web development company that focuses on building lean, smart and scalable websites, web applications and e-commerce platforms. We believe technical architecture and visual design go hand in hand, and that the design of a product does not stop at a pixel level. We work with small business, start-ups, emerging brands and other niche organizations to help create awesome products that captivate users." /> 
  <meta name="keywords" content="web development, chicago, development, design, e-commerce, application, marketing, tools, internet, branding, php, expressionengine, " />

	
  <!-- <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;" /> -->

  <meta name="google-site-verification" content="BFB6gDV5GkXJX_DR1sZJGShsJXJ-g1gUigO7q3mGL5g" />

	
	<link rel="shortcut icon" href="../assets/images/favicon.png" />
	<link rel="apple-touch-icon" href="../assets/images/favicon.png" />

	
	<link rel="stylesheet" href="../assets/css/global-v=1.css" />
	<link rel="stylesheet" href="../assets/js/fancybox/jquery.fancybox-1.3.4-v=1.css" />
	<link rel="stylesheet" href="../assets/js/syntaxhighlighter/styles/shCore.css" />
	<link rel="stylesheet" href="../assets/js/syntaxhighlighter/styles/shCoreDefault.css"/>
	<link rel="stylesheet" href="../assets/js/syntaxhighlighter/styles/shThemeRDark.css"/>
	
	
	
  
  <script>
    var _gaq = [['_setAccount', 'UA-23070397-1'], ['_trackPageview']]; 
    
    (function(d, t) {
      var g = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
      g.async = true;
      g.src = '//www.google-analytics.com/ga.js';
      s.parentNode.insertBefore(g, s);
      })(document, 'script');
  </script>
  
	
	
	<script src="../assets/js/modernizr-1.6.min.js"></script>
	
  <!-- facebook and twitter scripts -->
	<script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
	<script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script>
	
    
  
  
  <meta property="og:title" content="Setting Up an ExpressionEngine Site on Pagodabox"/>
  <meta property="og:type" content="article"/>
  <meta property="og:url" content="http://thegoodlab.com/articles/setting-up-an-expressionengine-site-on-pagodabox"/>
  <meta property="og:image" content="http://thegoodlab.com/assets/images/logo.png"/>
  <meta property="og:site_name" content="The Good Lab"/>
  <meta property="og:description" content="#Intro We've recently started to investigate cloud hosting platforms, such as PHPFog and Pagodabox, as an alternative to our current Linode hosting. While Linode is a fantastic host, each project requires that we spend an hour or so to provision our host for staging and production environments, and on top of that, the benefits of cloud scalability and managed hosting has really started to make sense for us internally. Over the past few weeks we've seen a few different mentions of setting up EE on one of these "cloud environments", and we wanted to share our experience doing just that."/>
  
  



</head>
<body>
  
  
    
  <div id='content-container' class='inside clearfix'>
    
    <section id='white-col-container'>
      
      <div class='responsive-inside clearfix'>

        <span id='twitter-title'>Obligatory Twitter Feed</span>

        <h1>The Good Lab</h1><span>mobile</span>

        

      </div><!-- .responsive-inside -->

    </section><!-- #white-col-container -->

    <section id='main-container'>
    
      <header class='clearfix'>
        <a id='h1_link' href='../index.html'><h1>THE GOOD LAB</h1></a>
        <nav>
          <ul class='has-layout'>
            <li class='col-1 first '><a href='../index.html'><span class='number'>01</span><span class='link-name'>Home</span></a></li>
            <li class='col-1 '><a href='../work.html'><span class='number'>02</span><span class='link-name'>Work</span></a></li>
            <li class='col-1 '><a href='../about.html'><span class='number'>03</span><span class='link-name'>About</span></a></li>
            <li class='col-1 '><a href='../contact.html'><span class='number'>04</span><span class='link-name'>Contact</span></a></li>
            <li class='col-1 here'><a href='../articles.html'><span class='number'>05</span><span class='link-name'>Articles</span></a></li>
          </ul>
        </nav>
        <ul id='dots' class='has-layout'>
          <li><a target="_blank" href='mailto:hello@thegoodlab.com'><img src='../assets/images/icon-mail.png' /></a></li>
          <li><a target="_blank" href='http://www.twitter.com/thegoodlab'><img src='../assets/images/icon-twitter.png' /></a></li>
          
          <li><a target="_blank" href='http://www.youtube.com/watch?v=vLReIhRgVS8'><img src='../assets/images/icon-question.png' /></a></li>
          
          
        </ul>
      </header>
      <div class='dotted-line'>&nbsp;</div>

  <section id='blog-listing-content-container' class='clearfix'>
    <section id='blog-listing-content-left' class='col-6 left first'>
      
      
        
  
  
  
<div class='blog-listing-article-container'>
  <h2><a href='setting-up-an-expressionengine-site-on-pagodabox.html' class='blog-title-link'>Setting Up an ExpressionEngine Site on Pagodabox</a></h2>
  <span class='blog-date'>Thursday, March 15th 2012</span>
  
  <div id='article-intro-content-container'>
	<div class="intro-text">

<p>There has been some talk around the EE community lately regarding cloud hosting solutions like FogPHP and Pagodabox.  While these platforms offer some great advantages from run-of-the-mill dedicated hosting providers, we had not seen anyone setup an EE site on one of them, or heard reports that it was actually possible.  In this article we will walk through our steps taken to get an EE site running on Pagodabox, and highlight some of the challenges (and solutions) we ran into along the way.</p>

</div>

	</div>

	<div id='article-content-container'>
    <h1>Intro</h1>

<p>We&#8217;ve recently started to investigate cloud hosting platforms, such as PHPFog and Pagodabox, as an alternative to our current Linode hosting.  While Linode is a fantastic host,  each project requires that we spend an hour or so to provision our host for staging and production environments, and on top of that, the benefits of cloud scalability and managed hosting has really started to make sense for us internally.  Over the past few weeks we&#8217;ve seen a few different mentions of setting up EE on one of these &#8220;cloud environments&#8221;, and we wanted to share our experience doing just that.  In this article we will describe the process of setting up an EE site on Pagodabox and also discuss some of the tricky parts we ran into.  Also, as a disclaimer, this is not an all-inclusive look at cloud hosting. It is merely an explanation of the steps we took to setup EE on one of these platforms.  Furthermore, this tutorial assumes you have an understanding of terminology like Git, SSH, Public Keys, Staging Environments, etc.  If you do not and get stuck on something, don&#8217;t be scared. Some quick Googling should to the trick.</p>

<p>Before we get started, we should first explain our typical multi-environment setup.  Typically when building EE sites, we will have a local  version of the EE project running on our individual machines where we develop the site locally.  Each site is version controlled using Git, and when we get to the point where we want to show the site to the client, we create a staging instance of site on our remote staging host.   From then on, we deploy all code changes to the staging environment using <a href="https://github.com/capistrano/capistrano">Capistrano</a>.  All production environments are setup in a similar fashion with deployments being handled through Capistrano.  To configure EE to the different environments we utilize Leevi Grahams <a href="http://ee-garage.com/nsm-config-bootstrap">Bootstrap Config</a> file, to handle different settings for different environments.  It should be noted that using some sort of dynamic, environment-specific configuration settings should be used when utilizing a cloud hosting platform.  This article will assume you currently are using one, and know how to configure EE settings to fit multiple environments.</p>

<h1>Why Pagodabox?</h1>

<p><a href="http://www.thegoodlab.com/content/uploads/PB-home.png" class="fancybox">
<img src="http://www.thegoodlab.com/content/uploads/PB-home.png" alt="Pagodabox Home" style="border: 0;" alt="image" />
</a></p>

<p>We&#8217;ve taken a look at two cloud hosting solutions <a href="https://phpfog.com/">PHPFog</a> and <a href="http://pagodabox.com">Pagodabox</a>. While both hosts seem like good solutions we ended up going with Pagodabox because it gives you the ability to create DB tunnels and manage your hosted DB using local tools such as Sequel Pro. Also because it allows you to SSH into your shared writeable directories, making backup and migration much easier.  Next, we&#8217;ll walk you through the process of getting a an EE instance up and running on Pagodabox.  Like many dev/design shops, in many cases we are setting up hosting for our clients, so this article points out a few places where the process is not so straight forward.</p>

<h1>Creating Your Account and Application</h1>

<p>The first step is creating an account with Pagoda Box.  Head over to <a href="http://pagodabox.com">http://pagodabox.com</a> and do just that.  After confirming your account and logging in for the first time, you get taken to this screen where you can create a new application.</p>

<p><a href="http://www.thegoodlab.com/content/uploads/PB_-_New_Application.png" class="fancybox">
<img src="http://www.thegoodlab.com/content/uploads/PB_-_New_Application.png" alt="Pagodabox Home" style="border: 0;" alt="image" />
</a></p>

<p>After clicking New Application you&#8217;re taken to a screen where you can pick how you want to <em>start</em> your application. For our purposes select <em>Empty Repo</em>, give your project a name and click Launch Application.</p>

<h2>Choosing a Deployment Method</h2>

<p><a href="http://www.thegoodlab.com/content/uploads/PB_-_Deployment_Method.png" class="fancybox">
<img src="http://www.thegoodlab.com/content/uploads/PB_-_Deployment_Method.png" alt="Pagodabox Home" style="border: 0;" alt="image" />
</a></p>

<p>After some quick processing you are taken to a new screen where you select your deployment method. This is one of the places we ran into some issues.  To preface the issue, the specific hiccup we ran into was related to a use-case where we were setting up a Pagodabox application for a non-technical client, using their own account credentials.  If you are not worried about this use-case and understand how to setup Git, feel free to disregard this issue and go ahead and setup your Git repository as the site directs.</p>

<p>As for our issue, Pagodabox only allows a single developer&#8217;s Public Key to be used once across their entire platform.  If you associate your Public Key with a Pagodabox account, you will not be able to use that same Public Key on another account.  This issue is tricky because if you create a new account for your client, then take steps to setup the application on your own machine, when you select to deploy via Git it will prompt you to enter your Public Key, however after submission it will alert you that the Public Key has already been associated to an account and can&#8217;t be used again.  This is a pretty big issue because it hypothetically means the account owner needs to understand how to create Public Keys and initialize Git repositories in order to setup an application.</p>

<p>There are two recommended workarounds for this situation.</p>

<ol>
<li><p>When logged into your clients account and creating a new application, when it asks you to choose your deployment method choose SFTP.  After your application has been created and you are taken to your application dashboard, go to the Admin section and then change the deployment method back to Git.  Lastly, add yourself as a collaborator to the application.  This will give you access to push and pull from the application&#8217;s Git repository. <a href="http://www.thegoodlab.com/content/uploads/PB_-_Switch_Deployment_Method.png" class="fancybox">
<img src="http://www.thegoodlab.com/content/uploads/PB_-_Switch_Deployment_Method.png" alt="Pagodabox Home" style="border: 0;" alt="image" />
</a></p></li>
<li><p>Instead of creating the application while logged in under your clients PagodaBox account, create the application as if it were your own, on your account.  Setup the application normally using Git and after you have created the application, you can add your client as a collaborator to the application.  After they have been added as a collaborator, there is the option to transfer ownership of the application to their account. <a href="http://www.thegoodlab.com/content/uploads/PB_-_Transfer_Ownership.png" class="fancybox">
<img src="http://www.thegoodlab.com/content/uploads/PB_-_Transfer_Ownership.png" alt="Pagodabox Home" style="border: 0;" alt="image" />
</a></p></li>
</ol>

<p>Continuing with our setup process, at this point you should either have created an application using Git as a deploy method or using SFTP.  If you did so using SFTP, follow the steps to switch the account to use Git deployment.</p>

<h1>Configuring Our Local Environment</h1>

<p>On our local machines there are a few key components we need to add to the codebase.</p>

<h2>Boxfile</h2>

<p>The Boxfile is a yaml based configuration file you can use to run tasks and specify various environment parameters for your PagodaBox application.  To learn more about the Box file, checkout this article: <a href="http://help.pagodabox.com/customer/portal/articles/175475-understanding-the-boxfile">Understanding the Boxfile</a>,  which goes into much more detail.  There are a plethora of configurations you are able to set in the Boxfile, but the two biggest in our case are:  <em>shared_writeable_dirs</em> and <em>php_extensions</em></p>

<p>Before we talk about these in more detail, here is the Boxfile used in our EE app.  Go ahead and add a copy to your application, which you will configure for your application.  The Boxfile should be located in the root of your application&#8217;s codebase and should be named &#8220;Boxfile&#8221; with no extension.</p>

<script type="syntaxhighlighter" class="brush: yaml;"><![CDATA[
web1:
  name: ee-test
  php_version: 5.3.5
  shared_writable_dirs:
    - content
    - system/expressionengine/cache
  php_extensions:
    - gd
    - mysql
]]></script>

<p>It should be noted that a Pagoda Box project does not actually need a Boxfile to run, and each Pagoda Box application has default settings applied to it when there is no Boxfile present in the repository.</p>

<h2>PHP Extensions</h2>

<p>For an EE project, we need to specify inside the Boxfile that we want to turn on the mysql extension and the GD image library extension.</p>

<div class='sidenote'>

<p>
When any php extensions are defined in the Boxfile, the default extensions are no longer recognized. You must include <strong>all</strong> extensions necessary to run your application.
</p>

</div>

<h2>Shared Writeable Directories</h2>

<p>The other configuration of our Boxfile is the <em>shared_writeable_dirs</em> setting.  This setting specifies writeable directories the application should have access to.  For example: file upload and cache directories.  One thing to note is that when these directories are specified in the Boxfile, and pushed to the PagodaBox environment, PagodaBox does some behind the scenes work to remove all contents of the specified directories and symlink them to a location that is not included in the Git repository.  Because of this removal and symlinking, the directories get emptied, which means you will have to upload any files and folders located in them via SSH or SFTP.  Inside your Boxfile change the <em>shared_writeable_dirs</em> settings to match your application&#8217;s requirements.</p>

<h2>Pagoda Gem</h2>

<p>Pagodabox provides a Ruby Gem to interact with your account and applications.  This gem can help you setup applications, create db tunnels, and deploy and rollback your application.  Before moving on, take a look at <a href="http://help.pagodabox.com/customer/portal/articles/175474">this article</a> and install the gem for yourself.</p>

<p>For our application, the main thing we use the gem for is to connect to our remote DB.  After installing the gem open terminal and navigate into your local version of the codebase.  From there enter the command</p>

<pre><code>$ pagoda tunnel -c db1
</code></pre>

<p>This should start the process of initiating a DB tunnel, which will allow you to connect to the DB with a tool such as Sequel Pro.</p>

<h1>Export and Import DB</h1>

<p>The next step is to export your local DB and import it into your PagodaBox hosted DB.  Go ahead&#8230;</p>

<h1>Push Codebase Live</h1>

<p>Lastly we want to push the code live.  Commit anything you have not yet and run:</p>

<pre><code>$ git push pagoda
</code></pre>

<p>After the push has executed, a few other commands get run and terminal should report the status of the deployment.</p>

<div class="sidenote">

<p>
If you don&#8217;t want your deployments to happen upon pushing changes live, you can disable the feature under the Admin section of the Pagodabox application control panel.  After doing so, you deploy using the _deploy_ command within the Pagoda gem.
</p>

</div>

<h1>Upload Shared Writeable Directory Content</h1>

<p>With the codebase pushed live, including our recently created Boxfile, the last step is moving files contained within your Shared Writeable Directories to your environment.  To do this, first you will need to enable SSH connection from the Pagodabox application control panel.  Navigate to the Admin page of your account and click the box next to where it says Enable SSH access to your writeable directories.</p>

<p><a href="http://www.thegoodlab.com/content/uploads/PB_-_Enable_SSH.png" class="fancybox">
<img src="http://www.thegoodlab.com/content/uploads/PB_-_Enable_SSH.png" alt="Pagodabox Home" style="border: 0;" alt="image" />
</a></p>

<p>After enabling writeable directories, you can SSH into your PB account or connect via SFTP.</p>

<p>Inside you will see a few folders, we are looking for the <em>shared</em> directory.  Inside the <em>shared</em> directory you&#8217;ll see the folders you specified as writeable inside your Boxfile, however their contents are empty.  Go ahead and upload the files you need to from your local version of the site.  Also, make sure you set the permissions of these folders correctly.  I know EE requires that file upload directories be 777, so make sure you have them set accordingly here.</p>

<h1>Test Out Your Site</h1>

<p>With the final steps completed, you should now be ready to test out your application.  Fire up the url provided by Pagodabox and see if everything is working correctly.</p>

<h1>Conclusion</h1>

<p>Almighty, clear as mud, right?  This process took us about a week&#8217;s worth of playing around with Pagodabox to figure out, so hopefully this helps push you in the right direction.  There is a chance we missed something along the way, so feel free to reach out in the comments with any comments or questions and we&#8217;ll do the best we can help.</p>

  </div>

  <div class='dotted-line mt30'></div>

  <div id='comments-container'>
    <span class='comments-container-title'>Comments</span>
    
    

    

    <div class="comment-container">
      <div class="comment-top clearfix">
        
                <img src="http://www.gravatar.com/avatar/912c13b1c08b4f0d8b6e97fe35d8ef91" class='avatar' alt="Joseph Brower's gravatar" />
                
        <div>
                      <a class='name' href='http://pagodabox.com'>Joseph Brower</a>
                      <span class='date'>3.21.12</span>
        </div>
      </div>
      <div class="comment-body">
        <p>As long as your store your sessions in a central location you should be ok.&nbsp; If you don&#8217;t specify anything, Pagoda Box will place them in a shared writable location.&nbsp; That trouble with that is that it isn&#8217;t as fast as other methods for session management.&nbsp; I&#8217;m unsure if EE supports it, but memcache with a lazy db write or redis work well for sessions in most cases.</p>
      </div>
    </div><!-- .comment-container -->

    

    

    <div class="comment-container">
      <div class="comment-top clearfix">
        
                <img src="http://www.gravatar.com/avatar/15e014b390fa9a298cc948082303d5e9" class='avatar' alt="Jason's gravatar" />
                
        <div>
                      <a class='name' href='http://surprisehighway.com'>Jason</a>
                      <span class='date'>3.19.12</span>
        </div>
      </div>
      <div class="comment-body">
        <p>Nice write up Bryant.</p>

<p>Did you play around with multiple front end load balanced servers at all? Just wondering if there are any special tricks to making EE sessions work in a load balanced environment? Or does it work automagically since sessions are stored in the db?</p>
      </div>
    </div><!-- .comment-container -->

    

  </div><!-- comments-container -->

  <div class='dotted-line mt30'></div>

  Commenting is not available in this channel entry.

</div>


  </section><!-- blog-listing-content-left -->
  <section id='blog-listing-content-right' class='col-3 left'>
    
    <h2>Article Categories</h2>
    <ul id='topic-list'>
      <ul>
<li>
      <li><a href="category/development/index.html" title="development">Development</a></li>   
      </li>
<li>
      <li><a href="category/process/index.html" title="process">Process</a></li>   
      </li>
</ul>

    </ul>

    <h2>Article Tags</h2>
    <ul id='topic-list'>
       
      <li><a href="tag/expression+engine/index.html" title="expression engine">expression engine</a></li>   
       
      <li><a href="tag/hosting/index.html" title="hosting">hosting</a></li>   
       
      <li><a href="tag/tutorial/index.html" title="tutorial">tutorial</a></li>   
       
      <li><a href="tag/tools/index.html" title="tools">tools</a></li>   
      
    </ul>
    
    <h2>Share</h2>
    <div id='share-container'>
      <div>
        <a href="http://twitter.com/share?url=&amp;via=The%20Good%20Lab" class="twitter-share-button">Tweet</a>
      </div>
     
      <div>
        <fb:like href="" layout="button_count" show_faces="false" width="70" font=""></fb:like>
      </div>  
    </div>
    
  </section>

    

      
    
  </section><!-- blog-listing-content-container -->

		<footer class='clear has-layout'>
		  <div class='dotted-line'></div>
		  <div id='footer-left'>
		    <img src='../assets/images/illinois.png' alt='illinois'>
		    Wicker Park - Chicago
		  </div>
		  <a href='mailto:hello@thegoodlab.com'>hello@thegoodlab.com</a>
		</footer>

	</section><!-- #main-container -->

</div><!-- #content-container -->

</body>


<!-- get clicky -->
<script type="text/javascript">
var clicky_site_ids = clicky_site_ids || [];
clicky_site_ids.push(66504950);
(function() {
  var s = document.createElement('script');
  s.type = 'text/javascript';
  s.async = true;
  s.src = '//static.getclicky.com/js';
  ( document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0] ).appendChild( s );
})();
</script>


<script type="text/javascript" src="../assets/js/syntaxhighlighter/scripts/shCore.js"></script>
<script type="text/javascript" src="../assets/js/syntaxhighlighter/scripts/shBrushPhp.js"></script>
<script type="text/javascript" src="../assets/js/syntaxhighlighter/scripts/shBrushJScript.js"></script>
<script type="text/javascript" src="../assets/js/syntaxhighlighter/scripts/shBrushXml.js"></script>
<script type="text/javascript" src="../assets/js/syntaxhighlighter/scripts/shBrushEE.js"></script>
<script type="text/javascript" src="../assets/js/syntaxhighlighter/scripts/shBrushYaml.js"></script>



<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script>/*<![CDATA[*/!window.jQuery && document.write('<script src="assets/js/jquery-1.4.4.min.js"><\/script>')/*]]>*/</script>


<script type="text/javascript" src="../assets/js/jquery.cycle.min.js"></script>
<script type="text/javascript" src="../assets/js/jquery.tmpl.min.js"></script>
<script type="text/javascript" src="../assets/js/fancybox/jquery.fancybox-1.3.4.pack.js"></script>


<script src="../assets/js/plugins-v=1.js"></script>
<script src="../assets/js/main-v=1.js"></script>


<!--[if lt IE 7 ]>
	<script type="text/javascript" src="assets/js/iepngfix_tilebg.js"></script>
	<style>
		/* Add comma-separated CSS selectors */
	 	img, div { behavior: url("assets/iepngfix.htc") }
	</style>
<![endif]-->

</body>
</html>